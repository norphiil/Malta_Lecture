# Lecture 8

## A = QR

Find QR decomposition of
A = [
    1, 1, 0
    1, 0, 1
    0, 1, 1
]

Gram-Schmidt formula:
u1 = a1
e1 = u1 / ||u1||
u2 = a2 - (a2 . e1) * e1

a1 = [1, 1, 0]^T
a2 = [1, 0, 1]^T
a3 = [0, 1, 1]^T

Performing the Gram-Schmidt:

uk = ak - (ak . e1) * e1 - (ak . e2) * e2 - ... - (ak . ek - 1) * ek - 1

u1 = a1 = [1, 1, 0]^T

e1 = [1/√2, 1/√2, 0]^T

u2 = a2 - (a2 . e1) * e1 = [1/2, -1/2, 1]^T

e2 = sqrt((1/2)^2 + (-1/2)^2 + 1^2) = sqrt(1/4 + 1/4 + 1) = sqrt(3/2)

e2 = [1/2√(3/2), -1/2√(3/2), √(2/3)/√(3/2)]^T

e2 = [1/√6, -1/√6, 2/√6]^T

u3 = a3 - (a3 . e1) * e1 - (a3 . e2) * e2 = [-2/3 2/3 2/3]^T

e3 = [-1/√3, 1/√3, 1/√3]^T

R = [
    e1 . a1, e1 . a2, e1 . a3
    0, e2 . a2, e2 . a3
    0, 0, e3 . a3
]

Q = [e1, e2, e3] = [
    1/√2, 1/√6, -1/√3
    1/√2, -1/√6, 1/√3
    0, 2/√6, 1/√3
]

R = [
    2/√2, 1/√2, 1/√2
    0, 3/√6, 1/√6
    0, 0, 2/√3
]

### Step 1

Decompose A using QR decomposition

A = [
    1, 2, 3
    4, 5, 6
    7, 8, 10
]

v1 = [1, 4, 7]^T
v2 = [2, 5, 8]^T
v3 = [3, 6, 10]^T

Performing the Gram-Schmidt:

u1 = v1 = [1, 4, 7]^T

e1 = sqrt(1^2 + 4^2 + 7^2) = sqrt(1 + 16 + 49) = sqrt(66)
e1 = u1 / ||u1||
e1 = 1/√66 * [1, 4, 7]^T = [1/√66, 4/√66, 7/√66]^T
e1 = [√66/66, 2√66/√33, 7√66/66]^T

u2 = v2 - (v2 . e1) * e1 = [2, 5, 8]^T - ([2, 5, 6]^T . [1/√66, 4/√66, 7/√66]^T) * [1/√66, 4/√66, 7/√66]^T
u2 = [2, 5, 8]^T - (2/√66 + 20/√66 + 56/√66) = [2, 5, 8]^T - 78/√66 = [-1/√66, 2/√66, 3/√66]^T

e2 = [1/6, -2/6, 3/6]^T

u3 = [√6/6, -√6/3, √6/6]^T

Q = [
    √66/66, 3√11/11, √6/6
    2√66/33, √11/11, -√6/3
    7√66/66, -√11/11, √6/6
]

R = [
    e1 . v1, e1 . v2, e1 . v3
    0, e2 . v2, e2 . v3
    0, 0, e3 . v3
]

where
v1 = [1, 4, 7]^T
v2 = [2, 5, 8]^T
v3 = [3, 6, 10]^T

R = [
    [√66/66, 3√11/11, √6/6]^T . [1, 4, 7]^T, [√66/66, 3√11/11, √6/6]^T . [2, 5, 8]^T, [√66/66, 3√11/11, √6/6]^T . [3, 6, 10]^T
    0, [1/6, -2/6, 3/6]^T . [2, 5, 8]^T, [1/6, -2/6, 3/6]^T . [3, 6, 10]^T
    0, 0, [√6/6, -√6/3, √6/6]^T . [3, 6, 10]^T
]

### Step 2

Q^Tb = [
    √66/66, 2√66/33, 7√66/66
    3√11/11, √11/11, -√11/11
    √6/6, -√6/3, √6/6
] [
    6
    15
    25
] = [
   (√66/66 * 6) + (2√66/33 * 15) + (7√66/66 * 25),
   (√66/66 * 6) + (2√66/33 * 15) + (7√66/66 * 25),
   (√66/66 * 6) + (2√66/33 * 15) + (7√66/66 * 25)
] = [
    241√66/66
    8√11/11
    1√6/6
]

Rx = Q^Tb

R = [
    √66, 13√66/11, 97√66/66
    0, 3√11/11, 5√11/11
    0, 0, √6/6
] [
    x1
    x2
    x3
] = [
    241√66/66
    8√11/11
    1√6/6
]

Therefore x3 = 1, x2 = 1, x1 = 1.

### Worksheets

1. Consider the matrix 𝐴:

A = [
    2, -2, 18
    2, 1, 0
    1, 2, 0
]

#### a. Orthogonalise the matrix 𝐴 using the Gram-Schmidt process.

#### b. Using your answer to (a), find the QR decomposition of the matrix 𝐴
