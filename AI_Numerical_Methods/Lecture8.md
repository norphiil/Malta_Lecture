# Lecture 8

## A = QR

Find QR decomposition of
A = [
    1, 1, 0
    1, 0, 1
    0, 1, 1
]

Gram-Schmidt formula:
u1 = a1
e1 = u1 / ||u1||
u2 = a2 - (a2 . e1) * e1

a1 = [1, 1, 0]^T
a2 = [1, 0, 1]^T
a3 = [0, 1, 1]^T

Performing the Gram-Schmidt:

uk = ak - (ak . e1) * e1 - (ak . e2) * e2 - ... - (ak . ek - 1) * ek - 1

u1 = a1 = [1, 1, 0]^T

e1 = [1/âˆš2, 1/âˆš2, 0]^T

u2 = a2 - (a2 . e1) * e1 = [1/2, -1/2, 1]^T

e2 = sqrt((1/2)^2 + (-1/2)^2 + 1^2) = sqrt(1/4 + 1/4 + 1) = sqrt(3/2)

e2 = [1/2âˆš(3/2), -1/2âˆš(3/2), âˆš(2/3)/âˆš(3/2)]^T

e2 = [1/âˆš6, -1/âˆš6, 2/âˆš6]^T

u3 = a3 - (a3 . e1) * e1 - (a3 . e2) * e2 = [-2/3 2/3 2/3]^T

e3 = [-1/âˆš3, 1/âˆš3, 1/âˆš3]^T

R = [
    e1 . a1, e1 . a2, e1 . a3
    0, e2 . a2, e2 . a3
    0, 0, e3 . a3
]

Q = [e1, e2, e3] = [
    1/âˆš2, 1/âˆš6, -1/âˆš3
    1/âˆš2, -1/âˆš6, 1/âˆš3
    0, 2/âˆš6, 1/âˆš3
]

R = [
    2/âˆš2, 1/âˆš2, 1/âˆš2
    0, 3/âˆš6, 1/âˆš6
    0, 0, 2/âˆš3
]

### Step 1

Decompose A using QR decomposition

A = [
    1, 2, 3
    4, 5, 6
    7, 8, 10
]

v1 = [1, 4, 7]^T
v2 = [2, 5, 8]^T
v3 = [3, 6, 10]^T

Performing the Gram-Schmidt:

u1 = v1 = [1, 4, 7]^T

e1 = sqrt(1^2 + 4^2 + 7^2) = sqrt(1 + 16 + 49) = sqrt(66)
e1 = u1 / ||u1||
e1 = 1/âˆš66 * [1, 4, 7]^T = [1/âˆš66, 4/âˆš66, 7/âˆš66]^T
e1 = [âˆš66/66, 2âˆš66/âˆš33, 7âˆš66/66]^T

u2 = v2 - (v2 . e1) * e1 = [2, 5, 8]^T - ([2, 5, 6]^T . [1/âˆš66, 4/âˆš66, 7/âˆš66]^T) * [1/âˆš66, 4/âˆš66, 7/âˆš66]^T
u2 = [2, 5, 8]^T - (2/âˆš66 + 20/âˆš66 + 56/âˆš66) = [2, 5, 8]^T - 78/âˆš66 = [-1/âˆš66, 2/âˆš66, 3/âˆš66]^T

e2 = [1/6, -2/6, 3/6]^T

u3 = [âˆš6/6, -âˆš6/3, âˆš6/6]^T

Q = [
    âˆš66/66, 3âˆš11/11, âˆš6/6
    2âˆš66/33, âˆš11/11, -âˆš6/3
    7âˆš66/66, -âˆš11/11, âˆš6/6
]

R = [
    e1 . v1, e1 . v2, e1 . v3
    0, e2 . v2, e2 . v3
    0, 0, e3 . v3
]

where
v1 = [1, 4, 7]^T
v2 = [2, 5, 8]^T
v3 = [3, 6, 10]^T

R = [
    [âˆš66/66, 3âˆš11/11, âˆš6/6]^T . [1, 4, 7]^T, [âˆš66/66, 3âˆš11/11, âˆš6/6]^T . [2, 5, 8]^T, [âˆš66/66, 3âˆš11/11, âˆš6/6]^T . [3, 6, 10]^T
    0, [1/6, -2/6, 3/6]^T . [2, 5, 8]^T, [1/6, -2/6, 3/6]^T . [3, 6, 10]^T
    0, 0, [âˆš6/6, -âˆš6/3, âˆš6/6]^T . [3, 6, 10]^T
]

### Step 2

Q^Tb = [
    âˆš66/66, 2âˆš66/33, 7âˆš66/66
    3âˆš11/11, âˆš11/11, -âˆš11/11
    âˆš6/6, -âˆš6/3, âˆš6/6
] [
    6
    15
    25
] = [
   (âˆš66/66 * 6) + (2âˆš66/33 * 15) + (7âˆš66/66 * 25),
   (âˆš66/66 * 6) + (2âˆš66/33 * 15) + (7âˆš66/66 * 25),
   (âˆš66/66 * 6) + (2âˆš66/33 * 15) + (7âˆš66/66 * 25)
] = [
    241âˆš66/66
    8âˆš11/11
    1âˆš6/6
]

Rx = Q^Tb

R = [
    âˆš66, 13âˆš66/11, 97âˆš66/66
    0, 3âˆš11/11, 5âˆš11/11
    0, 0, âˆš6/6
] [
    x1
    x2
    x3
] = [
    241âˆš66/66
    8âˆš11/11
    1âˆš6/6
]

Therefore x3 = 1, x2 = 1, x1 = 1.

### Worksheets

1. Consider the matrix ğ´:

A = [
    2, -2, 18
    2, 1, 0
    1, 2, 0
]

#### a. Orthogonalise the matrix ğ´ using the Gram-Schmidt process.

#### b. Using your answer to (a), find the QR decomposition of the matrix ğ´
